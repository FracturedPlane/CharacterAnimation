
\section{Framework}
\label{sec:framework}

\begin{figure}[H]
	\includegraphics[width=0.2\linewidth]{../images/2D-Biped-crop.pdf} \\
	\caption{\label{figure:2d-biped} 2D planar biped. Each link has $3$ degrees of freedom $\langle x, y, \theta \rangle$.}
\end{figure}

I constructed a $7$ link biped with $21$ degrees of freedom~\ref{figure:2d-biped}. 
The root link is the waist of the character.
In \bulletPhysics links are specified in world coordinates.
After the links are created the constraints between the links are also defined in world coordinates
 
Using the Featherstone algorithm the links between rigid bodies are constructed in a hierarchical fashion. 
To create a new link, a new rigid body is created and then it is added to the system by specifying the id of the parent rigidbody and the child rigidbody. 
For example, if the torso is link $0$ then the left and right thigh links would specify their parent link as $0$.
Links are chained together with \emph{joints} in a method similar to links.
For each joint the parent link needs to be set as well as the child link.
For a hinge joint the axis of rotation also needs to be defined.
Last, the location, in world coordinates, of the joint is defined.
The system also has support for other types of joints but they are not used in this project.

To drive the character each joint has a function to set the current torque for a particular link. 
This torque is automatically applied to both links without the need to enforce the rotation separately.
The link torques will be controlled using Proportional Derivative (PD) controllers.
Each link is driven to a target angle using the formula $\tau = \Kp(\theta_{d}- \theta) - \Kd\dot{\theta} $.
Each non-symmetric joint has different values for \Kp and \Kd.


\begin{enumerate}
	\item Constructing a character
	\item Featherstone arrangement
	\item Controlling joints
	\item PD control on these joints
	\item getting a statue
	\item Using different solvers	
\end{enumerate}

% Onto getting the character to walk
The character controller uses a state machine to choose the particular angles the biped should be driving toward. 
There are 4 states and these states are symmetric with respect to the left and right legs of the character.

\begin{table}
\centering
	\begin{tabular}{ c | c | c | c | c }
		            & state-0 & state-1 & state-2 & state-3 \\ \hline
         torso      &    0    &    0    &    0    & 0       \\
		 left-hip   &    0    &    0    &    0    & 0       \\
		 left-knee  &    0    &    0    &    0    & 0       \\
		left-ankle  &    0    &    0    &    0    & 0       \\
		 right-hip  &    0    &    0    &    0    & 0       \\
		right-knee  &    0    &    0    &    0    & 0       \\
		right-ankle &    0    &    0    &    0    & 0
	\end{tabular}
	\caption{\label{table:controler-values}}
\end{table}

The joint angles for each of the state are listed in Table~\ref{table:controler-values}.

\todo{description of the states, maybe as picutres}

\subsection{Swing Leg Control}

\begin{enumerate}
	\item Some math for SIMBICON..
	\item implementing them in BulletPhysics
\end{enumerate}